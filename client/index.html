<!doctype html>
  <html lang="en">
    <head>
      <meta charset="UTF-8">
        <title>CH8EX4: Ship Animation Loop</title>
    </head>
    <body>
      <main>

        <canvas id="ship" width="800" height="420">
         Your browser does not support HTML5 Canvas.
        </canvas>

    </main>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
   canvasApp();
});

function canvasApp() {
   var canvas = document.getElementById("ship");
   if (!canvas || !canvas.getContext) console.log('Canvas element has not loaded');

   var context = canvas.getContext("2d");
   if (!context) console.log('Canvas element has not loaded');

   let rotation = 0;
   let x = 50;
   let y = 50;
   let width = 50;
   let height = 50;
   let W = (width/2) * -1;
   let H = (height/2) * -1;
   let angle = 0;
   let canvasWidth = canvas.width;
   let canvasHeight = canvas.height;

   //canvasApp level variables
   var shipState = 0; //0 = static, 1 = thrust

   function drawScreen() {
     // draw background and text
     context.fillStyle = '#000000';
     context.fillRect(0, 0, canvasWidth, canvasHeight);
     context.fillStyle = '#ffffff';
     context.font = '20px _sans';
     context.textBaseline = 'top';
     context.fillText  ("Player UI Here", 20, 390);

     //  transformation
     let angleInRadians = rotation * Math.PI / 180;
     context.save();    // save the current stack
     context.setTransform(1,0,0,1,0,0); //  reset to identity

     //  translate canvas origin to center of Player
     context.translate(x,y);
     

      //update the shipState
      shipState++;
      if (shipState >1) {
         shipState=0;
    }


    //drawShip
    context.strokeStyle = '#ffffff';
    context.beginPath();
    context.moveTo(10,0);
    context.lineTo(19,19);
    context.lineTo(10,9);
    context.moveTo(9,9);
    context.lineTo(0,19);
    context.lineTo(9,0);

    if (shipState==1) {
       //draw thrust
       context.moveTo(8,13);
       context.lineTo(11,13);
       context.moveTo(9,14);
       context.lineTo(9,18);
       context.moveTo(10,14);
       context.lineTo(10,18);
    }

    context.stroke();
    context.closePath();
   }

   const FRAME_RATE = 40;
   var intervalTime = 1000/FRAME_RATE;
   setInterval(drawScreen, intervalTime );
}
// requestAnim shim layer by Paul Irish
window.requestAnimFrame = (function(){
  return  window.requestAnimationFrame   ||
      window.webkitRequestAnimationFrame ||
      window.mozRequestAnimationFrame    ||
      window.oRequestAnimationFrame      ||
      window.msRequestAnimationFrame     ||
      function(/* function */ callback, /* DOMElement */ element){
        window.setTimeout(callback, 1000 / 250);
      };
})();


</script>
</body>
</html>
