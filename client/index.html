<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/client/css/style.css">
  </head>

  <!-- <body onload="init()"> -->
  <body>
    <main >
      <div class="stars"></div>
      <div class="twinkling"></div>
      <div class="clouds"></div>

      <!-- The canvas for the panning background -->
  		<canvas id="background" width='500' height='500'>
  			Your browser does not support canvas.
        Please try again with a different browser.
  		</canvas>
  		<canvas id="ship" width="600" height="360">

    </main>

    <!-- <script src='/client/js/main.js'></script> -->
     <script>
      document.addEventListener("DOMContentLoaded", function(event) {
        let x = 200;
        let y = 200;
        let width = 57;
        let height = 101;
        let key, pos = 0;

        let shipCanvas = document.getElementById('ship');
        let shipContext = shipCanvas.getContext('2d');
        let imgSpaceship = new Image();  //  want this in

        let map = [ false, false, false, false ];

        let resetMap = function () {
          for (i=0;i<map.length;i++) {
            map[i] = false;
          }
        };

        var clearScreen = function () {
          shipContext.clearRect(0, 0, 600, 360 );
        }

        //  define Ship class
        let Ship = function () {
          this.x = 50;
          this.y = 50;
          this.h = 50;
          this.w = 50;
          this.speed = 0;
        }

        //  draw method Ship class
        Ship.prototype.draw = function () {
          shipContext.drawImage(imgSpaceship, x, y);
          imgSpaceship.src = "/client/imgs/ship2.png";
        }

        // move method ship class
        Ship.prototype.move = function () {
          var speed = 3;
          // shipContext.clearRect(x, y, 600, 360);
          if(pos==0)return;
          if(key==37) {
            x-=speed;
            if (x<=0) x=0;
          }  // left
          if(key==38) {
            y-=speed;
            if (y<=0) y=0;
          } // up
          if(key==39) {
            x+=speed;
            if (x >= shipCanvas.width - width)
    					x = shipCanvas.width - width;
          }
          if(key==40) {
            y+=speed;  // down
            if (y >= shipCanvas.height - height)
              y = shipCanvas.height - height;
          }
        }


        document.onkeydown = function (e) {
          pos = 1;
          key = window.event ? e.keyCode : e.which;
        };
        document.onkeyup=function(e){
          pos=0;
        };

        //  Make a new ship
        let ship = new Ship();
            ship.draw();

        function render () {
          ship.move();
          clearScreen();
          ship.draw();
          requestAnimFrame( render );
        }(render());  //  IIFE calls itself
      });

      // requestAnim shim layer by Paul Irish
      window.requestAnimFrame = (function(){
      	return  window.requestAnimationFrame   ||
      			window.webkitRequestAnimationFrame ||
      			window.mozRequestAnimationFrame    ||
      			window.oRequestAnimationFrame      ||
      			window.msRequestAnimationFrame     ||
      			function(/* function */ callback, /* DOMElement */ element){
      				window.setTimeout(callback, 1000 / 6);
      			};
      })();
    </script>

  </body>
</html>
