<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/client/css/style.css">
  </head>

  <!-- <body onload="init()"> -->
  <body>
    <main >
      <div class="stars"></div>
      <div class="twinkling"></div>
      <div class="clouds"></div>

      <!-- The canvas for the panning background -->
  		<canvas id="background" width='500' height='500'>
  			Your browser does not support canvas.
        Please try again with a different browser.
  		</canvas>
  		<canvas id="ship" width="600" height="360">

    </main>

    <!-- <script src='/client/js/main.js'></script> -->
     <script>
      document.addEventListener("DOMContentLoaded", function(event) {
        let x = 200;
        let y = 200;
        let width = 57;
        let height = 101;

        let shipCanvas = document.getElementById('ship');
        let shipContext = shipCanvas.getContext('2d');
        let imgSpaceship = new Image();  //  want this in

        let map = [ false, false, false, false ];

        let resetMap = function () {
          for (i=0;i<map.length;i++) {
            map[i] = false;
          }
        };

        var clearScreen = function () {
          shipContext.clearRect(0, 0, 600, 360 );
        }

        //  define Ship class
        let Ship = function () {
          this.x = 50;
          this.y = 50;
          this.h = 50;
          this.w = 50;
          this.speed = 0;
        }

        //  draw method Ship class
        Ship.prototype.draw = function () {
          shipContext.drawImage(imgSpaceship, x, y);
          imgSpaceship.src = "/client/imgs/ship2.png";
        }

        // move method ship class
        Ship.prototype.move = function () {
          speed = 4;
          clearScreen();
          if(map[3]) {
            x-=speed;
            if (x<=0) x=0;
          }  // left
          if(map[0]) {
            y-=speed;
            if (y<=0) y=0;
          } // up
          if(map[1]) {
            x+=speed;
            if (x >= shipCanvas.width - width)
    					x = shipCanvas.width - width;
          }
          if(map[2]) {
            y+=speed;  // down
            if (y >= shipCanvas.height - height)
              y = shipCanvas.height - height;
          }
        }


        document.onkeydown = function (e) {
          if(e.keyCode == 38 && e.keyCode == 39) {
            map[0] = true;
            map[1] = true;
          }
          else if(e.keyCode == 38) {
              map[0] = true;
           }
          if(e.keyCode == 39) {
              map[1] = true;
           }
          if(e.keyCode == 40) {
              map[2] = true;
           }
          if(e.keyCode == 37) {
              map[3] = true;
           }
        };
        document.onkeyup=function(e){
          resetMap();
        };

        //  Make a new ship
        let ship = new Ship();
            ship.draw();

        function render () {
          ship.move();
          clearScreen();
          ship.draw();
          requestAnimFrame( render );
        }(render());  //  IIFE calls itself
      });

      // The keycodes mapped when presses a button.
      KEY_CODES = {
        32: 'space',
        37: 'left',
        38: 'up',
        39: 'right',
        40: 'down',
      };

      KEY_STATUS = {};
      for (code in KEY_CODES) {
        KEY_STATUS[KEY_CODES[code]] = false;
      }
      console.log(KEY_STATUS.left);

      // requestAnim shim layer by Paul Irish
      window.requestAnimFrame = (function(){
      	return  window.requestAnimationFrame   ||
      			window.webkitRequestAnimationFrame ||
      			window.mozRequestAnimationFrame    ||
      			window.oRequestAnimationFrame      ||
      			window.msRequestAnimationFrame     ||
      			function(/* function */ callback, /* DOMElement */ element){
      				window.setTimeout(callback, 1000 / 6);
      			};
      })();
    </script>

  </body>
</html>
